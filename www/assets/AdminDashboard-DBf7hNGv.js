import{f as i,j as e,af as w,al as c,a$ as S,B as o,ad as C,b0 as T,aT as H,aS as L,bP as D,l as x,a2 as m,aa as h,b7 as p,m as b,bQ as I,bR as R,bS as n,bT as l,bU as A,bV as s,H as u,bL as B,ba as K,b4 as f,Q as P}from"./index-QOByuYTn.js";import{S as Q}from"./shield-alert-RaJDFZxy.js";function U(){const{data:j,isLoading:g}=i({queryKey:P.healthFull,refetchInterval:3e4}),{data:N,isLoading:v}=i({queryKey:["/api/monitoring/stats"],refetchInterval:1e4}),{data:k,isLoading:y}=i({queryKey:["/api/monitoring/crashes"],refetchInterval:15e3}),r=N?.data||{},t=j?.health||{},d=k?.data||[];return g||v||y?e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",dir:"rtl",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(w,{className:"h-12 w-12 animate-spin text-primary opacity-20"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground animate-pulse",children:"جاري تحميل لوحة التحكم الإدارية..."})]})}):e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 pb-20 md:pb-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-end gap-3 px-1",children:[e.jsxs(c,{variant:t?.status==="healthy"?"success":"warning",className:"h-8 px-3 text-[11px] font-bold flex items-center gap-2 rounded-full shadow-sm",children:[e.jsx(S,{className:"h-3.5 w-3.5"}),t?.status==="healthy"?"النظام مستقر":"تنبيه في الأداء"]}),e.jsxs(o,{variant:"outline",size:"sm",className:"h-8 rounded-full text-[11px] font-medium bg-white/50 backdrop-blur-sm",children:[e.jsx(C,{className:"ml-1.5 h-3.5 w-3.5"}),"تحديث تلقائي"]})]}),e.jsx("div",{className:"px-1",children:e.jsx(T,{stats:[{title:"الأجهزة النشطة",value:r.activeDevices||"0",icon:H,color:"blue",description:"أجهزة متصلة حالياً"},{title:"معدل الانهيارات",value:`${r.crashRate||"0"}%`,icon:Q,color:"red",status:(r.crashRate||0)>1?"critical":"normal",description:"آخر 24 ساعة"},{title:"زمن استجابة API",value:`${t?.metrics?.averageLatency||"0"}ms`,icon:L,color:"green",status:(t?.metrics?.averageLatency||0)>500?"warning":"normal",description:"متوسط الاستجابة"},{title:"حالة الخادم",value:t?.status==="healthy"?"ممتازة":"تحتاج فحص",icon:D,color:"purple",description:"صحة النظام المركزية"}],columns:4,hideHeader:!0})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-7 px-1",children:[e.jsxs(x,{className:"col-span-full lg:col-span-4 shadow-sm border-slate-200 dark:border-slate-800 rounded-3xl overflow-hidden bg-white/70 backdrop-blur-md",children:[e.jsx(m,{className:"border-b border-slate-100 dark:border-slate-800 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{className:"text-base font-bold text-slate-900 dark:text-white",children:"آخر الانهيارات (Crashes)"}),e.jsx(p,{className:"text-[11px]",children:"أحدث المشاكل التقنية المسجلة من أجهزة الميدان."})]}),e.jsx(o,{variant:"ghost",size:"sm",className:"text-primary text-[11px] font-bold",children:"عرض الكل"})]})}),e.jsx(b,{className:"p-0 overflow-x-auto",children:e.jsxs(I,{children:[e.jsx(R,{children:e.jsxs(n,{className:"hover:bg-transparent border-slate-50 dark:border-slate-800",children:[e.jsx(l,{className:"text-right pr-6 text-[11px] font-bold text-slate-400 uppercase tracking-wider",children:"الجهاز"}),e.jsx(l,{className:"text-right text-[11px] font-bold text-slate-400 uppercase tracking-wider",children:"نوع الخطأ"}),e.jsx(l,{className:"text-right text-[11px] font-bold text-slate-400 uppercase tracking-wider",children:"الخطورة"}),e.jsx(l,{className:"text-right text-[11px] font-bold text-slate-400 uppercase tracking-wider",children:"الوقت"}),e.jsx(l,{})]})}),e.jsx(A,{children:d&&d.length>0?d.map(a=>e.jsxs(n,{className:"group cursor-pointer border-slate-50 dark:border-slate-800 hover:bg-slate-50/50 transition-colors",children:[e.jsx(s,{className:"font-bold text-sm pr-6 text-slate-700 dark:text-slate-200",children:a.deviceId||a.device}),e.jsx(s,{children:e.jsx("code",{className:"text-[10px] bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded-md font-mono text-slate-600 dark:text-slate-400 border border-slate-200/50 dark:border-slate-700/50",children:a.exceptionType||a.type})}),e.jsx(s,{children:e.jsx(c,{variant:a.severity==="critical"?"destructive":"warning",className:"text-[9px] px-2 py-0 rounded-full font-bold uppercase",children:a.severity==="critical"?"حرج":"تحذير"})}),e.jsx(s,{className:"text-[10px] text-slate-400 font-medium",children:a.timestamp?u(new Date(a.timestamp),"HH:mm",{locale:f}):u(new Date,"HH:mm",{locale:f})}),e.jsx(s,{className:"text-left pl-4",children:e.jsx(B,{className:"h-4 w-4 text-slate-300 group-hover:text-primary transition-all transform group-hover:translate-x-[-2px]"})})]},a.id)):e.jsx(n,{children:e.jsx(s,{colSpan:5,className:"h-32 text-center text-muted-foreground text-xs italic",children:"لا يوجد بلاغات انهيار حالياً"})})})]})})]}),e.jsxs(x,{className:"col-span-full lg:col-span-3 shadow-sm border-slate-200 dark:border-slate-800 rounded-3xl overflow-hidden bg-white/70 backdrop-blur-md",children:[e.jsxs(m,{className:"border-b border-slate-100 dark:border-slate-800 pb-4",children:[e.jsx(h,{className:"text-base font-bold text-slate-900 dark:text-white",children:"مؤشرات الأداء (KPIs)"}),e.jsx(p,{className:"text-[11px]",children:"توزيع كفاءة الأنظمة والخدمات."})]}),e.jsxs(b,{className:"space-y-6 pt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[e.jsx("span",{className:"font-bold text-slate-600 dark:text-slate-400",children:"استقرار المزامنة (Sync)"}),e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-black",children:"98.2%"})]}),e.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-blue-500 to-blue-300 rounded-full transition-all duration-1000",style:{width:"98.2%"}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[e.jsx("span",{className:"font-bold text-slate-600 dark:text-slate-400",children:"صحة قاعدة البيانات"}),e.jsx("span",{className:"text-green-600 dark:text-green-400 font-black",children:"99.9%"})]}),e.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:border-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-green-500 to-green-300 rounded-full transition-all duration-1000",style:{width:"99.9%"}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[e.jsx("span",{className:"font-bold text-slate-600 dark:text-slate-400",children:"توافر الـ Backend"}),e.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-black",children:"100%"})]}),e.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-purple-500 to-purple-300 rounded-full transition-all duration-1000",style:{width:"100%"}})})]}),e.jsx("div",{className:"pt-4 mt-2 border-t border-slate-50 dark:border-slate-800",children:e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-2xl bg-slate-50/50 dark:bg-slate-900/50 border border-slate-100/50 dark:border-slate-800/50",children:[e.jsx("div",{className:"bg-amber-100 dark:bg-amber-900/30 p-1.5 rounded-lg",children:e.jsx(K,{className:"h-4 w-4 text-amber-500 shrink-0"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[11px] font-black text-slate-800 dark:text-slate-200",children:"تنبيه ذكي:"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 leading-relaxed font-medium",children:"تم رصد زيادة طفيفة في زمن استجابة API خلال الساعة الأخيرة. يوصى بمراجعة سجلات الاتصال."})]})]})})]})]})]})]})}export{U as default};
