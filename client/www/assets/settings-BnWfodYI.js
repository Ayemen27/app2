import{ap as F,bi as J,bj as A,bk as K,a as $,r as g,bl as G,j as e,ag as H,ah as Q,ai as o,aj as _,ab as C,aU as T,ba as W,ak as x,l as m,a2 as h,aa as u,aV as X,b1 as j,m as p,L as r,K as L,M as D,N as E,O as I,R as N,ao as f,B as i,k as Y,an as Z,q as ee,b5 as se,bm as ae,bn as le,ae as te,bo as re}from"./index-TJZT-xVx.js";import{S as d}from"./switch-Baub8tYx.js";import{U as ce}from"./upload-DD1IpB4u.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=F("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),ne=["syncQueue","userData","projects","workers","materials","suppliers","expenses"];async function ie(){const s={};for(const t of ne)try{s[t]=await J(t)}catch{s[t]=[]}const a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),n=URL.createObjectURL(a),l=document.createElement("a");return l.href=n,l.download=`binarjoin-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n),"تم تصدير البيانات بنجاح"}async function de(s){try{const a=JSON.parse(s),n=Object.keys(a);for(const l of n){const t=a[l];Array.isArray(t)&&t.length>0&&(await A(l),await K(l,t))}}catch(a){throw console.error("[Backup] Import failed:",a),new Error("فشل استيراد البيانات: تنسيق غير صالح")}}async function oe(){try{const s=["projects","workers","materials","suppliers","workerAttendance","materialPurchases","transportationExpenses","fundTransfers","workerTransfers","workerMiscExpenses","wells","projectTypes"];for(const a of s)await A(a);return!0}catch(s){return console.error("[Cleanup] Error clearing all data:",s),!1}}function je(){const{toast:s}=$(),[a,n]=g.useState(!1),{manualSync:l,isSyncing:t,isOnline:R}=G(),[b,U]=g.useState(null),[w,v]=g.useState(!1),y=async()=>{const c=await re();U(c)};g.useEffect(()=>{n(document.documentElement.classList.contains("dark")),y()},[]);const z=async()=>{try{await ie(),s({title:"تم التصدير بنجاح",description:"تم حفظ نسخة احتياطية من بياناتك المحلية"})}catch{s({title:"خطأ في التصدير",variant:"destructive"})}},M=async c=>{const k=c.target.files?.[0];if(!k)return;v(!0);const S=new FileReader;S.onload=async q=>{try{await de(q.target?.result),await y(),s({title:"تم الاستيراد بنجاح",description:"تم تحديث البيانات المحلية من النسخة الاحتياطية"})}catch{s({title:"خطأ في الاستيراد",description:"تأكد من صحة ملف النسخة الاحتياطية",variant:"destructive"})}finally{v(!1)}},S.readAsText(k)},B=async()=>{confirm("هل أنت متأكد من مسح جميع البيانات المحلية؟ سيتم حذف جميع العمليات غير المتزامنة.")&&(await oe(),await y(),s({title:"تم مسح البيانات",description:"تم تنظيف قاعدة البيانات المحلية بنجاح"}))},P=c=>{n(c),c?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")),s({title:c?"تم تفعيل الوضع الليلي":"تم تفعيل الوضع النهاري",duration:2e3})},V=()=>{s({title:"تم حفظ الإعدادات",description:"تم تحديث تفضيلاتك بنجاح"})};return e.jsx("div",{className:"container mx-auto p-4 max-w-4xl animate-in fade-in duration-500 pb-20",children:e.jsxs(H,{defaultValue:"general",className:"space-y-6",children:[e.jsxs(Q,{className:"bg-muted/50 p-1 rounded-xl w-full justify-start overflow-x-auto h-auto",children:[e.jsxs(o,{value:"general",className:"rounded-lg gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"عام"]}),e.jsxs(o,{value:"offline",className:"rounded-lg gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"البيانات (Offline)"]}),e.jsxs(o,{value:"appearance",className:"rounded-lg gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"المظهر"]}),e.jsxs(o,{value:"notifications",className:"rounded-lg gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"التنبيهات"]}),e.jsxs(o,{value:"security",className:"rounded-lg gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"الأمان"]})]}),e.jsx(x,{value:"general",className:"space-y-4",children:e.jsxs(m,{className:"border-border/40 shadow-sm rounded-2xl overflow-hidden",children:[e.jsxs(h,{className:"pb-3",children:[e.jsxs(u,{className:"text-lg flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-blue-500"}),"تفضيلات التطبيق"]}),e.jsx(j,{children:"الإعدادات الأساسية لواجهة التطبيق"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"لغة النظام"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"اختر اللغة المفضلة لواجهة المستخدم"})]}),e.jsxs(L,{defaultValue:"ar",children:[e.jsx(D,{className:"w-[140px] rounded-xl",children:e.jsx(E,{placeholder:"اختر اللغة"})}),e.jsxs(I,{children:[e.jsx(N,{value:"ar",children:"العربية"}),e.jsx(N,{value:"en",children:"English"})]})]})]}),e.jsx(f,{className:"opacity-50"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"تحديث تلقائي"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"تحديث البيانات بشكل دوري في الخلفية"})]}),e.jsx(d,{defaultChecked:!0})]})]})]})}),e.jsx(x,{value:"offline",className:"space-y-4",children:e.jsxs(m,{className:"border-border/40 shadow-sm rounded-2xl overflow-hidden",children:[e.jsxs(h,{className:"pb-3",children:[e.jsxs(u,{className:"text-lg flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-blue-500"}),"إدارة البيانات المحلية (Offline)"]}),e.jsx(j,{children:"تحكم في البيانات المخزنة على جهازك والمزامنة مع السيرفر"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-border/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"عمليات معلقة للمزامنة"}),e.jsx("p",{className:"text-xl font-bold text-orange-600",children:b?.pendingSync||0})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-border/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"بيانات محلية محفوظة"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:b?.localUserData||0})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(i,{variant:"outline",size:"sm",className:"gap-2 rounded-xl",onClick:z,children:[e.jsx(Y,{className:"h-3.5 w-3.5"}),"تصدير نسخة"]}),e.jsxs("div",{className:"relative",children:[e.jsxs(i,{variant:"outline",size:"sm",className:"gap-2 rounded-xl",disabled:w,children:[e.jsx(ce,{className:"h-3.5 w-3.5"}),"استيراد نسخة"]}),e.jsx(Input,{type:"file",accept:".json",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:M,disabled:w})]}),e.jsxs(i,{variant:"secondary",size:"sm",className:"gap-2 rounded-xl",onClick:()=>l(),disabled:!R||t||b?.pendingSync===0,children:[e.jsx(Z,{className:`h-3.5 w-3.5 ${t?"animate-spin":""}`}),"مزامنة الآن"]}),e.jsxs(i,{variant:"ghost",size:"sm",className:"gap-2 rounded-xl text-destructive hover:bg-destructive/10",onClick:B,children:[e.jsx(ee,{className:"h-3.5 w-3.5"}),"مسح البيانات"]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-100 dark:border-yellow-900/30 rounded-xl flex gap-3 items-start",children:[e.jsx(se,{className:"h-5 w-5 text-yellow-600 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-yellow-800 dark:text-yellow-200 leading-relaxed",children:"يتم تخزين بياناتك محلياً لتمكينك من العمل بدون إنترنت. عند مسح البيانات المحلية، ستفقد أي عمليات لم يتم مزامنتها مع السيرفر بعد."})]})]})]})}),e.jsx(x,{value:"appearance",className:"space-y-4",children:e.jsxs(m,{className:"border-border/40 shadow-sm rounded-2xl overflow-hidden",children:[e.jsxs(h,{className:"pb-3",children:[e.jsxs(u,{className:"text-lg flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5 text-purple-500"}),"تخصيص المظهر"]}),e.jsx(j,{children:"تغيير ألوان وسمات التطبيق"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(r,{className:"text-base flex items-center gap-2",children:[a?e.jsx(ae,{className:"h-4 w-4"}):e.jsx(le,{className:"h-4 w-4"}),"الوضع الليلي"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"تبديل بين الوضع الفاتح والداكن"})]}),e.jsx(d,{checked:a,onCheckedChange:P})]}),e.jsx(f,{className:"opacity-50"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"حجم الخط"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"تعديل حجم خط النصوص في التطبيق"})]}),e.jsxs(L,{defaultValue:"medium",children:[e.jsx(D,{className:"w-[140px] rounded-xl",children:e.jsx(E,{placeholder:"اختر الحجم"})}),e.jsxs(I,{children:[e.jsx(N,{value:"small",children:"صغير"}),e.jsx(N,{value:"medium",children:"متوسط"}),e.jsx(N,{value:"large",children:"كبير"})]})]})]})]})]})}),e.jsx(x,{value:"notifications",className:"space-y-4",children:e.jsxs(m,{className:"border-border/40 shadow-sm rounded-2xl overflow-hidden",children:[e.jsxs(h,{className:"pb-3",children:[e.jsxs(u,{className:"text-lg flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-orange-500"}),"إعدادات التنبيهات"]}),e.jsx(j,{children:"إدارة كيفية استلام الإشعارات"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"إشعارات الدفع (Push)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"استلام تنبيهات على المتصفح أو الجهاز"})]}),e.jsx(d,{defaultChecked:!0})]}),e.jsx(f,{className:"opacity-50"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"تنبيهات المصروفات"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"الإخطار عند تسجيل مصروفات كبيرة"})]}),e.jsx(d,{defaultChecked:!0})]}),e.jsx(f,{className:"opacity-50"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"تنبيهات الحضور"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"الإخطار عند اكتمال كشف الحضور اليومي"})]}),e.jsx(d,{})]})]})]})}),e.jsx(x,{value:"security",className:"space-y-4",children:e.jsxs(m,{className:"border-border/40 shadow-sm rounded-2xl overflow-hidden",children:[e.jsxs(h,{className:"pb-3",children:[e.jsxs(u,{className:"text-lg flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-green-500"}),"الأمان والخصوصية"]}),e.jsx(j,{children:"إعدادات حماية الحساب والبيانات"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"التحقق بخطوتين (2FA)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"إضافة طبقة حماية إضافية لحسابك"})]}),e.jsx(i,{variant:"outline",size:"sm",className:"rounded-xl",children:"تفعيل"})]}),e.jsx(f,{className:"opacity-50"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"قفل التطبيق"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"طلب كلمة مرور عند فتح التطبيق"})]}),e.jsx(d,{})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(i,{variant:"outline",className:"rounded-xl px-8",children:"إلغاء"}),e.jsx(i,{onClick:V,className:"rounded-xl px-8",children:"حفظ التغييرات"})]})]})})}export{je as default};
