
#!/bin/bash

# ุณูุฑูุจุช ุฅุฏุงุฑุฉ ุงูุชุทุจูููู
# ./manage-apps.sh [start|stop|restart|status|logs]

case "$1" in
    start)
        echo "๐ ุจุฏุก ุชุดุบูู ุงูุชุทุจูููู..."
        
        # ุงูุชุฃูุฏ ูู ูุฌูุฏ ูุฌูุฏ ุงูุณุฌูุงุช
        mkdir -p logs
        
        # ุจูุงุก ุชุทุจูู app2
        echo "๐ฆ ุจูุงุก ุชุทุจูู app2..."
        npm run build
        
        # ุชุดุบูู ุงูุชุทุจูููู ุจุงุณุชุฎุฏุงู PM2
        pm2 start ecosystem.config.json
        
        echo "โ ุชู ุจุฏุก ุชุดุบูู ุงูุชุทุจูููู ุจูุฌุงุญ"
        pm2 status
        ;;
        
    stop)
        echo "๐ ุฅููุงู ุงูุชุทุจูููู..."
        pm2 stop all
        echo "โ ุชู ุฅููุงู ุฌููุน ุงูุชุทุจููุงุช"
        ;;
        
    restart)
        echo "๐ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูููู..."
        pm2 restart all
        echo "โ ุชู ุฅุนุงุฏุฉ ุชุดุบูู ุฌููุน ุงูุชุทุจููุงุช"
        pm2 status
        ;;
        
    status)
        echo "๐ ุญุงูุฉ ุงูุชุทุจููุงุช:"
        pm2 status
        ;;
        
    logs)
        if [ -n "$2" ]; then
            echo "๐ ุณุฌูุงุช ุงูุชุทุจูู $2:"
            pm2 logs "$2" --lines 50
        else
            echo "๐ ุณุฌูุงุช ุฌููุน ุงูุชุทุจููุงุช:"
            pm2 logs --lines 20
        fi
        ;;
        
    monitor)
        echo "๐ ูุฑุงูุจุฉ ุงูุชุทุจููุงุช ุงููุจุงุดุฑุฉ:"
        pm2 monit
        ;;
        
    save)
        echo "๐พ ุญูุธ ูุงุฆูุฉ ุงูุชุทุจููุงุช ููุชุดุบูู ุงูุชููุงุฆู..."
        pm2 save
        pm2 startup
        echo "โ ุชู ุญูุธ ุงูุฅุนุฏุงุฏุงุช"
        ;;
        
    *)
        echo "ุงูุงุณุชุฎุฏุงู: $0 {start|stop|restart|status|logs [app-name]|monitor|save}"
        echo ""
        echo "ุงูุฃูุงูุฑ ุงููุชุงุญุฉ:"
        echo "  start     - ุจุฏุก ุชุดุบูู ุงูุชุทุจูููู"
        echo "  stop      - ุฅููุงู ุงูุชุทุจูููู"
        echo "  restart   - ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูููู"
        echo "  status    - ุนุฑุถ ุญุงูุฉ ุงูุชุทุจููุงุช"
        echo "  logs      - ุนุฑุถ ุงูุณุฌูุงุช"
        echo "  monitor   - ูุฑุงูุจุฉ ูุจุงุดุฑุฉ"
        echo "  save      - ุญูุธ ููุชุดุบูู ุงูุชููุงุฆู"
        echo ""
        echo "ูุซุงู:"
        echo "  $0 start"
        echo "  $0 logs app2"
        echo "  $0 logs bot-v4"
        exit 1
        ;;
esac
