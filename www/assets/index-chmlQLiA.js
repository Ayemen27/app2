import{ap as j,f as n,j as e,af as o,al as l,a$ as y,b0 as b,bM as v,ad as N,aS as k,l as c,a2 as d,aa as m,T as w,m as x,bN as C,ba as L,Q as S}from"./index-QOByuYTn.js";import{R as M,A,C as U,X as D,Y as T,T as $,a as z}from"./AreaChart-Bys9Axpi.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=j("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);function F(){const{data:r,isLoading:h}=n({queryKey:S.healthFull,refetchInterval:3e4}),{data:R,isLoading:p}=n({queryKey:["/api/monitoring/stats"],refetchInterval:1e4});if(h||statsLoading||p)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"h-12 w-12 animate-spin text-primary opacity-20"}),e.jsx(o,{className:"h-12 w-12 animate-ping text-primary absolute top-0 left-0"})]}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground animate-pulse",children:"جاري تحليل أداء النظام..."})]})});const t=statsData?.data||{},s=r?.health||{},i=r?.metrics||{},u=a=>{if(!a)return"0 ثانية";const f=Math.floor(a/3600),g=Math.floor(a%3600/60);return`${f} ساعة و ${g} دقيقة`};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-slate-900 to-slate-500 dark:from-white dark:to-slate-400 bg-clip-text text-transparent",children:"نظام الرصد المركزي"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"مراقبة حية لأداء الخادم، صحة البيانات، والعمليات الذكية."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(l,{variant:s?.status==="healthy"?"success":"warning",className:"h-9 px-4 text-sm font-bold flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),s?.status==="healthy"?"نظام مستقر":"تنبيه في الأداء"]}),e.jsxs("div",{className:"text-[10px] text-muted-foreground text-left hidden md:block",children:["آخر تحديث: ",new Date().toLocaleTimeString("ar-SA")]})]})]}),e.jsx(b,{stats:[{title:"استهلاك المعالج (CPU)",value:`${t.cpuUsage||0}%`,icon:K,color:"blue",status:(t.cpuUsage||0)>80?"critical":"normal"},{title:"استهلاك الذاكرة",value:`${t.memoryUsage||0}%`,icon:v,color:"purple",status:(t.memoryUsage||0)>85?"warning":"normal"},{title:"وقت التشغيل المتواصل",value:u(t.uptime||0),icon:N,color:"green"},{title:"متوسط زمن الاستجابة",value:`${i.averageLatency||0}ms`,icon:k,color:"orange",status:(i.averageLatency||0)>500?"warning":"normal"}],columns:4,hideHeader:!0}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(c,{className:"lg:col-span-2 shadow-sm border-slate-200 dark:border-slate-800",children:[e.jsx(d,{className:"flex flex-row items-center justify-between border-b pb-4",children:e.jsxs("div",{children:[e.jsxs(m,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5 text-primary"}),"تحليل زمن استجابة قاعدة البيانات"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"تتبع تاريخي لزمن الوصول للبيانات (Latency History)"})]})}),e.jsx(x,{className:"h-[350px] pt-6",children:e.jsx(M,{width:"100%",height:"100%",children:e.jsxs(A,{data:r?.health?.history||[],children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorLatency",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"hsl(var(--primary))",stopOpacity:.15}),e.jsx("stop",{offset:"95%",stopColor:"hsl(var(--primary))",stopOpacity:0})]})}),e.jsx(U,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--border))",opacity:.5}),e.jsx(D,{dataKey:"timestamp",tickFormatter:a=>new Date(a).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),stroke:"hsl(var(--muted-foreground))",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(T,{stroke:"hsl(var(--muted-foreground))",fontSize:10,tickLine:!1,axisLine:!1,tickFormatter:a=>`${a}ms`}),e.jsx($,{contentStyle:{backgroundColor:"hsl(var(--card))",borderColor:"hsl(var(--border))",borderRadius:"var(--radius)",fontSize:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},itemStyle:{color:"hsl(var(--primary))"},labelFormatter:a=>`التوقيت: ${new Date(a).toLocaleTimeString("ar-SA")}`}),e.jsx(z,{type:"monotone",dataKey:"checks.database.latency",name:"زمن الاستجابة",stroke:"hsl(var(--primary))",fillOpacity:1,fill:"url(#colorLatency)",strokeWidth:2,animationDuration:1500})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(C,{}),e.jsxs(c,{className:"shadow-sm border-slate-200 dark:border-slate-800",children:[e.jsx(d,{className:"pb-3 border-b",children:e.jsxs(m,{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4 text-orange-500"}),"المؤشرات الأمنية والوقائية"]})}),e.jsx(x,{className:"pt-4",children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-medium",children:"Circuit Breakers"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"أنظمة العزل التلقائي"})]}),e.jsxs(l,{variant:"outline",className:"font-mono",children:[s?.checks?.circuitBreakers?.total||0," نشط"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-medium",children:"وضع الطوارئ"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Emergency Mode"})]}),e.jsx(l,{variant:s?.emergencyMode?"destructive":"secondary",className:"animate-pulse",children:s?.emergencyMode?"مفعل (خطر)":"متوقف"})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-medium",children:"قاعدة البيانات"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Database Status"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${s?.checks?.database?.status?"bg-green-500":"bg-red-500"} animate-pulse`}),e.jsx("span",{className:"text-xs font-bold",children:s?.checks?.database?.status?"متصلة":"منقطعة"})]})]})]})})]})]})]})]})}export{F as default};
