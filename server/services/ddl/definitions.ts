export const DATABASE_DDL: Record<string, string> = {
  users: `CREATE TABLE IF NOT EXISTS users (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), email TEXT NOT NULL UNIQUE, password TEXT NOT NULL, password_algo TEXT NOT NULL DEFAULT 'argon2id', first_name TEXT, last_name TEXT, full_name TEXT, phone TEXT, role TEXT NOT NULL DEFAULT 'admin', is_active BOOLEAN NOT NULL DEFAULT true, email_verified_at TIMESTAMP, totp_secret TEXT, mfa_enabled BOOLEAN DEFAULT false, fcm_token TEXT, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now(), last_login TIMESTAMP, is_local BOOLEAN DEFAULT false, synced BOOLEAN DEFAULT true, pending_sync BOOLEAN DEFAULT false, version INTEGER DEFAULT 1, last_modified_by VARCHAR(255))`,
  refresh_tokens: `CREATE TABLE IF NOT EXISTS refresh_tokens (id UUID PRIMARY KEY DEFAULT gen_random_uuid(), user_id VARCHAR(255) NOT NULL REFERENCES users(id) ON DELETE CASCADE, token_hash TEXT NOT NULL, replaced_by UUID, revoked BOOLEAN DEFAULT false NOT NULL, expires_at TIMESTAMP NOT NULL, ip_address TEXT, user_agent TEXT, device_fingerprint TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  audit_logs: `CREATE TABLE IF NOT EXISTS audit_logs (id SERIAL PRIMARY KEY, user_id VARCHAR(255) REFERENCES users(id), action TEXT NOT NULL, meta JSONB, ip_address TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  emergency_users: `CREATE TABLE IF NOT EXISTS emergency_users (id VARCHAR(255) PRIMARY KEY, email TEXT NOT NULL UNIQUE, password TEXT NOT NULL, name TEXT NOT NULL, role TEXT NOT NULL DEFAULT 'admin', created_at TIMESTAMP NOT NULL DEFAULT now())`,
  auth_user_sessions: `CREATE TABLE IF NOT EXISTS auth_user_sessions (id UUID PRIMARY KEY DEFAULT gen_random_uuid(), user_id VARCHAR(255) NOT NULL REFERENCES users(id), session_token VARCHAR(255), device_fingerprint VARCHAR(255), user_agent TEXT, ip_address INET, location_data JSONB, is_trusted_device BOOLEAN DEFAULT false NOT NULL, expires_at TIMESTAMP NOT NULL, last_activity TIMESTAMP DEFAULT now(), created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now(), device_id VARCHAR(255), device_name VARCHAR(255), browser_name VARCHAR(255), browser_version VARCHAR(255), os_name VARCHAR(255), os_version VARCHAR(255), country VARCHAR(255), city VARCHAR(255), timezone VARCHAR(255), login_method VARCHAR(255), security_flags JSONB, device_type VARCHAR(255), refresh_token_hash TEXT, access_token_hash TEXT, is_revoked BOOLEAN DEFAULT false NOT NULL, revoked_at TIMESTAMP WITH TIME ZONE, revoked_reason VARCHAR(255))`,
  email_verification_tokens: `CREATE TABLE IF NOT EXISTS email_verification_tokens (id UUID PRIMARY KEY DEFAULT gen_random_uuid(), user_id VARCHAR(255) NOT NULL REFERENCES users(id), email TEXT NOT NULL, token VARCHAR(255) NOT NULL UNIQUE, token_hash VARCHAR(255) NOT NULL, verification_link TEXT NOT NULL, expires_at TIMESTAMP NOT NULL, verified_at TIMESTAMP, created_at TIMESTAMP NOT NULL DEFAULT now(), ip_address INET, user_agent TEXT, attempts_count INTEGER DEFAULT 0 NOT NULL)`,
  password_reset_tokens: `CREATE TABLE IF NOT EXISTS password_reset_tokens (id UUID PRIMARY KEY DEFAULT gen_random_uuid(), user_id VARCHAR(255) NOT NULL REFERENCES users(id), token VARCHAR(255) NOT NULL UNIQUE, token_hash VARCHAR(255) NOT NULL, expires_at TIMESTAMP NOT NULL, used_at TIMESTAMP, created_at TIMESTAMP NOT NULL DEFAULT now(), ip_address INET, user_agent TEXT)`,
  project_types: `CREATE TABLE IF NOT EXISTS project_types (id SERIAL PRIMARY KEY, name VARCHAR(100) NOT NULL UNIQUE, description TEXT, is_active BOOLEAN DEFAULT true NOT NULL, created_at TIMESTAMP DEFAULT now() NOT NULL, is_local BOOLEAN DEFAULT false, synced BOOLEAN DEFAULT true, pending_sync BOOLEAN DEFAULT false, version INTEGER DEFAULT 1, last_modified_by VARCHAR(255))`,
  projects: `CREATE TABLE IF NOT EXISTS projects (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), name TEXT NOT NULL UNIQUE, description TEXT, location TEXT, client_name TEXT, budget DECIMAL(15,2), start_date DATE, end_date DATE, status TEXT NOT NULL DEFAULT 'active', engineer_id VARCHAR(255), manager_name TEXT, contact_phone TEXT, notes TEXT, image_url TEXT, project_type_id INTEGER REFERENCES project_types(id) ON DELETE SET NULL, is_active BOOLEAN NOT NULL DEFAULT true, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now(), is_local BOOLEAN DEFAULT false, synced BOOLEAN DEFAULT true, pending_sync BOOLEAN DEFAULT false, version INTEGER DEFAULT 1, last_modified_by VARCHAR(255))`,
  workers: `CREATE TABLE IF NOT EXISTS workers (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), name TEXT NOT NULL UNIQUE, type TEXT NOT NULL, daily_wage DECIMAL(15,2) NOT NULL, phone TEXT, hire_date TEXT, is_active BOOLEAN NOT NULL DEFAULT true, created_at TIMESTAMP NOT NULL DEFAULT now(), is_local BOOLEAN DEFAULT false, synced BOOLEAN DEFAULT true, pending_sync BOOLEAN DEFAULT false, version INTEGER DEFAULT 1, last_modified_by VARCHAR(255))`,
  wells: `CREATE TABLE IF NOT EXISTS wells (id SERIAL PRIMARY KEY, project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, well_number INTEGER NOT NULL, owner_name TEXT NOT NULL, region VARCHAR(100) NOT NULL, number_of_bases INTEGER NOT NULL, base_count INTEGER, number_of_panels INTEGER NOT NULL, panel_count INTEGER, well_depth INTEGER NOT NULL, water_level INTEGER, number_of_pipes INTEGER NOT NULL, pipe_count INTEGER, fan_type VARCHAR(100), pump_power INTEGER, status TEXT NOT NULL DEFAULT 'pending', completion_percentage DECIMAL(5,2) DEFAULT 0 NOT NULL, start_date DATE, completion_date DATE, notes TEXT, created_by VARCHAR(255) NOT NULL REFERENCES users(id), created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now(), is_local BOOLEAN DEFAULT false, synced BOOLEAN DEFAULT true, pending_sync BOOLEAN DEFAULT false, version INTEGER DEFAULT 1, last_modified_by VARCHAR(255))`,
  fund_transfers: `CREATE TABLE IF NOT EXISTS fund_transfers (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, amount DECIMAL(15,2) NOT NULL, sender_name TEXT, transfer_number TEXT UNIQUE, transfer_type TEXT NOT NULL, transfer_date TEXT NOT NULL, notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  worker_attendance: `CREATE TABLE IF NOT EXISTS worker_attendance (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, worker_id VARCHAR(255) NOT NULL REFERENCES workers(id) ON DELETE CASCADE, attendance_date TEXT NOT NULL, date TEXT, start_time TEXT, end_time TEXT, work_description TEXT, is_present BOOLEAN, hours_worked DECIMAL(5,2) DEFAULT 8.00, overtime DECIMAL(5,2) DEFAULT 0.00, overtime_rate DECIMAL(15,2) DEFAULT 0.00, work_days DECIMAL(10,2) DEFAULT 0.00, daily_wage DECIMAL(15,2) NOT NULL, actual_wage DECIMAL(15,2), total_pay DECIMAL(15,2) NOT NULL, paid_amount DECIMAL(15,2) DEFAULT 0, remaining_amount DECIMAL(15,2) DEFAULT 0, payment_type TEXT DEFAULT 'partial', notes TEXT, well_id INTEGER REFERENCES wells(id) ON DELETE SET NULL, created_at TIMESTAMP NOT NULL DEFAULT now(), UNIQUE(worker_id, attendance_date, project_id))`,
  suppliers: `CREATE TABLE IF NOT EXISTS suppliers (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), name TEXT NOT NULL UNIQUE, contact_person TEXT, phone TEXT, address TEXT, payment_terms TEXT DEFAULT 'نقد', total_debt DECIMAL(12,2) NOT NULL DEFAULT 0, is_active BOOLEAN NOT NULL DEFAULT true, notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  materials: `CREATE TABLE IF NOT EXISTS materials (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), name TEXT NOT NULL, category TEXT NOT NULL, unit TEXT NOT NULL, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  material_purchases: `CREATE TABLE IF NOT EXISTS material_purchases (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, supplier_id VARCHAR(255) REFERENCES suppliers(id) ON DELETE SET NULL, material_id VARCHAR(255) REFERENCES materials(id) ON DELETE SET NULL, material_name TEXT NOT NULL, material_category TEXT, material_unit TEXT, quantity DECIMAL(10,3) NOT NULL, unit TEXT NOT NULL, unit_price DECIMAL(15,2) NOT NULL, total_amount DECIMAL(15,2) NOT NULL, purchase_type TEXT NOT NULL DEFAULT 'نقد', paid_amount DECIMAL(15,2) NOT NULL DEFAULT 0, remaining_amount DECIMAL(15,2) NOT NULL DEFAULT 0, supplier_name TEXT, receipt_number TEXT, invoice_number TEXT, invoice_date TEXT, due_date TEXT, invoice_photo TEXT, notes TEXT, purchase_date TEXT NOT NULL, well_id INTEGER REFERENCES wells(id) ON DELETE SET NULL, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  supplier_payments: `CREATE TABLE IF NOT EXISTS supplier_payments (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), supplier_id VARCHAR(255) NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE, project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, purchase_id VARCHAR(255) REFERENCES material_purchases(id) ON DELETE SET NULL, amount DECIMAL(15,2) NOT NULL, payment_method TEXT NOT NULL DEFAULT 'نقد', payment_date TEXT NOT NULL, reference_number TEXT, notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  transportation_expenses: `CREATE TABLE IF NOT EXISTS transportation_expenses (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, worker_id VARCHAR(255) REFERENCES workers(id) ON DELETE SET NULL, amount DECIMAL(15,2) NOT NULL, description TEXT NOT NULL, category TEXT NOT NULL DEFAULT 'other', date TEXT NOT NULL, notes TEXT, well_id INTEGER REFERENCES wells(id) ON DELETE SET NULL, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  worker_transfers: `CREATE TABLE IF NOT EXISTS worker_transfers (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), worker_id VARCHAR(255) NOT NULL REFERENCES workers(id) ON DELETE CASCADE, project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, amount DECIMAL(15,2) NOT NULL, transfer_number TEXT, sender_name TEXT, recipient_name TEXT NOT NULL, recipient_phone TEXT, transfer_method TEXT NOT NULL, transfer_date TEXT NOT NULL, notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  worker_balances: `CREATE TABLE IF NOT EXISTS worker_balances (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), worker_id VARCHAR(255) NOT NULL REFERENCES workers(id) ON DELETE CASCADE, project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, total_earned DECIMAL(15,2) NOT NULL DEFAULT 0, total_paid DECIMAL(15,2) NOT NULL DEFAULT 0, total_transferred DECIMAL(15,2) NOT NULL DEFAULT 0, current_balance DECIMAL(15,2) NOT NULL DEFAULT 0, last_updated TIMESTAMP NOT NULL DEFAULT now(), created_at TIMESTAMP NOT NULL DEFAULT now())`,
  daily_activity_logs: `CREATE TABLE IF NOT EXISTS daily_activity_logs (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, engineer_id VARCHAR(255) NOT NULL REFERENCES users(id), log_date TEXT NOT NULL, activity_title TEXT NOT NULL, description TEXT, progress_percentage INTEGER DEFAULT 0, weather_conditions TEXT, images JSONB DEFAULT '[]', created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  daily_expense_summaries: `CREATE TABLE IF NOT EXISTS daily_expense_summaries (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, date TEXT NOT NULL, total_income DECIMAL(15,2) NOT NULL DEFAULT 0, total_expenses DECIMAL(15,2) NOT NULL DEFAULT 0, closing_balance DECIMAL(15,2) NOT NULL DEFAULT 0, notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  worker_types: `CREATE TABLE IF NOT EXISTS worker_types (id SERIAL PRIMARY KEY, name TEXT NOT NULL UNIQUE, usage_count INTEGER DEFAULT 0, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  autocomplete_data: `CREATE TABLE IF NOT EXISTS autocomplete_data (id SERIAL PRIMARY KEY, category TEXT NOT NULL, value TEXT NOT NULL, usage_count INTEGER DEFAULT 0, last_used TIMESTAMP DEFAULT now(), UNIQUE(category, value))`,
  worker_misc_expenses: `CREATE TABLE IF NOT EXISTS worker_misc_expenses (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), project_id VARCHAR(255) NOT NULL REFERENCES projects(id) ON DELETE CASCADE, worker_id VARCHAR(255) NOT NULL REFERENCES workers(id) ON DELETE CASCADE, amount DECIMAL(15,2) NOT NULL, description TEXT NOT NULL, date TEXT NOT NULL, notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  print_settings: `CREATE TABLE IF NOT EXISTS print_settings (id SERIAL PRIMARY KEY, user_id VARCHAR(255) REFERENCES users(id), report_type TEXT NOT NULL, header_title TEXT, header_subtitle TEXT, footer_text TEXT, show_logo BOOLEAN DEFAULT true, logo_url TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  project_fund_transfers: `CREATE TABLE IF NOT EXISTS project_fund_transfers (id SERIAL PRIMARY KEY, from_project_id VARCHAR(255) NOT NULL REFERENCES projects(id), to_project_id VARCHAR(255) NOT NULL REFERENCES projects(id), amount DECIMAL(15,2) NOT NULL, transfer_date TEXT NOT NULL, notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  report_templates: `CREATE TABLE IF NOT EXISTS report_templates (id SERIAL PRIMARY KEY, name TEXT NOT NULL, content JSONB NOT NULL, is_active BOOLEAN DEFAULT true, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  tools: `CREATE TABLE IF NOT EXISTS tools (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), name TEXT NOT NULL, code TEXT NOT NULL UNIQUE, category_id VARCHAR(255), status TEXT NOT NULL DEFAULT 'available', condition TEXT NOT NULL DEFAULT 'excellent', purchase_price DECIMAL(15,2), current_value DECIMAL(15,2), purchase_date DATE, supplier_id VARCHAR(255) REFERENCES suppliers(id), serial_number TEXT, barcode TEXT, qr_code TEXT, image_urls TEXT[], notes TEXT, specifications JSONB, total_usage_hours DECIMAL(15,2) DEFAULT 0, usage_count INTEGER DEFAULT 0, ai_rating DECIMAL(3,2), ai_notes TEXT, is_active BOOLEAN DEFAULT true NOT NULL, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  tool_categories: `CREATE TABLE IF NOT EXISTS tool_categories (id SERIAL PRIMARY KEY, name TEXT NOT NULL UNIQUE, description TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  tool_stock: `CREATE TABLE IF NOT EXISTS tool_stock (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), tool_id VARCHAR(255) NOT NULL REFERENCES tools(id) ON DELETE CASCADE, location_type TEXT NOT NULL, location_id VARCHAR(255), location_name TEXT, quantity INTEGER NOT NULL DEFAULT 0, available_quantity INTEGER NOT NULL DEFAULT 0, reserved_quantity INTEGER NOT NULL DEFAULT 0, notes TEXT, last_verified_at TIMESTAMP, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now(), UNIQUE (tool_id, location_type, location_id))`,
  tool_movements: `CREATE TABLE IF NOT EXISTS tool_movements (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), tool_id VARCHAR(255) NOT NULL REFERENCES tools(id) ON DELETE CASCADE, movement_type TEXT NOT NULL, quantity INTEGER NOT NULL, from_type TEXT, from_id VARCHAR(255), to_type TEXT, to_id VARCHAR(255), project_id VARCHAR(255) REFERENCES projects(id), reason TEXT, notes TEXT, reference_number TEXT, performed_by TEXT NOT NULL, performed_at TIMESTAMP NOT NULL DEFAULT now())`,
  tool_maintenance_logs: `CREATE TABLE IF NOT EXISTS tool_maintenance_logs (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), tool_id VARCHAR(255) NOT NULL REFERENCES tools(id) ON DELETE CASCADE, maintenance_type TEXT NOT NULL, priority TEXT NOT NULL DEFAULT 'medium', title TEXT NOT NULL, description TEXT, work_performed TEXT, scheduled_date TIMESTAMP, started_at TIMESTAMP, completed_at TIMESTAMP, next_due_date TIMESTAMP, status TEXT NOT NULL DEFAULT 'scheduled', labor_cost DECIMAL(12,2) DEFAULT 0, parts_cost DECIMAL(12,2) DEFAULT 0, total_cost DECIMAL(12,2) DEFAULT 0, performed_by VARCHAR(255) REFERENCES users(id), assigned_to VARCHAR(255) REFERENCES users(id), condition_before TEXT, condition_after TEXT, image_urls TEXT[], document_urls TEXT[], notes TEXT, issues TEXT, recommendations TEXT, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  tool_usage_analytics: `CREATE TABLE IF NOT EXISTS tool_usage_analytics (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), tool_id VARCHAR(255) NOT NULL REFERENCES tools(id) ON DELETE CASCADE, project_id VARCHAR(255) REFERENCES projects(id), analysis_date TEXT NOT NULL, analysis_week TEXT, analysis_month TEXT, usage_hours DECIMAL(15,2) DEFAULT 0, transfer_count INTEGER DEFAULT 0, maintenance_count INTEGER DEFAULT 0, operational_cost DECIMAL(12,2) DEFAULT 0, maintenance_cost DECIMAL(12,2) DEFAULT 0, utilization_rate DECIMAL(5,2), efficiency_score DECIMAL(5,2), predicted_usage DECIMAL(15,2), created_at TIMESTAMP NOT NULL DEFAULT now())`,
  tool_purchase_items: `CREATE TABLE IF NOT EXISTS tool_purchase_items (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), material_purchase_id VARCHAR(255) NOT NULL REFERENCES material_purchases(id) ON DELETE CASCADE, item_name TEXT NOT NULL, item_description TEXT, quantity INTEGER NOT NULL DEFAULT 1, unit_price DECIMAL(12,2) NOT NULL, total_price DECIMAL(12,2) NOT NULL, is_tool_item BOOLEAN DEFAULT false NOT NULL, suggested_category_id VARCHAR(255), conversion_status TEXT NOT NULL DEFAULT 'pending', tool_id VARCHAR(255) REFERENCES tools(id), ai_confidence DECIMAL(5,2), ai_suggestions JSONB, notes TEXT, converted_at TIMESTAMP, converted_by VARCHAR(255) REFERENCES users(id), created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  maintenance_schedules: `CREATE TABLE IF NOT EXISTS maintenance_schedules (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), tool_id VARCHAR(255) NOT NULL REFERENCES tools(id) ON DELETE CASCADE, schedule_type TEXT NOT NULL, interval_days INTEGER, interval_weeks INTEGER, interval_months INTEGER, usage_hours_interval DECIMAL(15,2), usage_count_interval INTEGER, is_active BOOLEAN DEFAULT true NOT NULL, last_maintenance_date TIMESTAMP, next_due_date TIMESTAMP NOT NULL, maintenance_type TEXT NOT NULL DEFAULT 'preventive', priority TEXT NOT NULL DEFAULT 'medium', estimated_duration INTEGER, estimated_cost DECIMAL(12,2), assigned_to VARCHAR(255) REFERENCES users(id), created_by VARCHAR(255) REFERENCES users(id), title TEXT NOT NULL, description TEXT, checklist_items JSONB, enable_notifications BOOLEAN DEFAULT true NOT NULL, notify_days_before INTEGER DEFAULT 3 NOT NULL, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  maintenance_tasks: `CREATE TABLE IF NOT EXISTS maintenance_tasks (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), schedule_id VARCHAR(255) NOT NULL REFERENCES maintenance_schedules(id) ON DELETE CASCADE, tool_id VARCHAR(255) NOT NULL REFERENCES tools(id) ON DELETE CASCADE, task_name TEXT NOT NULL, task_description TEXT, task_type TEXT NOT NULL, priority TEXT NOT NULL DEFAULT 'medium', status TEXT NOT NULL DEFAULT 'pending', due_date TIMESTAMP NOT NULL, started_at TIMESTAMP, completed_at TIMESTAMP, estimated_duration INTEGER, actual_duration INTEGER, estimated_cost DECIMAL(12,2), actual_cost DECIMAL(12,2), assigned_to VARCHAR(255) REFERENCES users(id), performed_by VARCHAR(255) REFERENCES users(id), result TEXT, findings TEXT, actions_taken TEXT, recommendations TEXT, before_images TEXT[], after_images TEXT[], document_urls TEXT[], materials_used JSONB, performer_signature TEXT, supervisor_signature TEXT, approved_by VARCHAR(255) REFERENCES users(id), approved_at TIMESTAMP, notes TEXT, internal_notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  tool_cost_tracking: `CREATE TABLE IF NOT EXISTS tool_cost_tracking (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), tool_id VARCHAR(255) NOT NULL REFERENCES tools(id) ON DELETE CASCADE, cost_type TEXT NOT NULL, cost_category TEXT NOT NULL, amount DECIMAL(12,2) NOT NULL, currency TEXT NOT NULL DEFAULT 'YER', cost_date TEXT NOT NULL, cost_period TEXT, reference_type TEXT, reference_id VARCHAR(255), description TEXT NOT NULL, notes TEXT, approved_by VARCHAR(255) REFERENCES users(id), approved_at TIMESTAMP, project_id VARCHAR(255) REFERENCES projects(id), created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now(), UNIQUE (tool_id, cost_date))`,
  tool_reservations: `CREATE TABLE IF NOT EXISTS tool_reservations (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), tool_id VARCHAR(255) NOT NULL REFERENCES tools(id) ON DELETE CASCADE, project_id VARCHAR(255) NOT NULL REFERENCES projects(id), quantity INTEGER NOT NULL, reserved_by VARCHAR(255) NOT NULL REFERENCES users(id), reservation_date TIMESTAMP DEFAULT now() NOT NULL, requested_date TIMESTAMP NOT NULL, expiry_date TIMESTAMP, status TEXT NOT NULL DEFAULT 'pending', priority TEXT NOT NULL DEFAULT 'normal', reason TEXT, notes TEXT, approved_by VARCHAR(255) REFERENCES users(id), approved_at TIMESTAMP, fulfilled_by VARCHAR(255) REFERENCES users(id), fulfilled_at TIMESTAMP, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  system_notifications: `CREATE TABLE IF NOT EXISTS system_notifications (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), type TEXT NOT NULL, category TEXT NOT NULL, title TEXT NOT NULL, message TEXT NOT NULL, description TEXT, priority TEXT NOT NULL DEFAULT 'medium', severity TEXT NOT NULL DEFAULT 'info', status TEXT NOT NULL DEFAULT 'active', source_type TEXT, source_id VARCHAR(255), source_name TEXT, user_id VARCHAR(255) REFERENCES users(id), target_audience TEXT DEFAULT 'all', action_required BOOLEAN DEFAULT false NOT NULL, action_url TEXT, action_label TEXT, scheduled_for TIMESTAMP, expires_at TIMESTAMP, read_at TIMESTAMP, dismissed_at TIMESTAMP, metadata JSONB, attachments TEXT[], view_count INTEGER DEFAULT 0 NOT NULL, click_count INTEGER DEFAULT 0 NOT NULL, last_viewed_at TIMESTAMP, is_system BOOLEAN DEFAULT false NOT NULL, is_auto_generated BOOLEAN DEFAULT true NOT NULL, is_persistent BOOLEAN DEFAULT false NOT NULL, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  notification_read_states: `CREATE TABLE IF NOT EXISTS notification_read_states (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), notification_id TEXT NOT NULL, user_id VARCHAR(255) REFERENCES users(id), is_read BOOLEAN DEFAULT true NOT NULL, read_at TIMESTAMP DEFAULT now() NOT NULL, device_info TEXT, created_at TIMESTAMP DEFAULT now() NOT NULL, UNIQUE (notification_id, user_id))`,
  build_deployments: `CREATE TABLE IF NOT EXISTS build_deployments (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), build_number INTEGER NOT NULL, status TEXT NOT NULL DEFAULT 'running', current_step TEXT NOT NULL, progress INTEGER NOT NULL DEFAULT 0, version TEXT NOT NULL, app_type TEXT NOT NULL DEFAULT 'web', logs JSONB NOT NULL DEFAULT '[]', steps JSONB NOT NULL DEFAULT '[]', start_time TIMESTAMP DEFAULT now() NOT NULL, end_time TIMESTAMP, triggered_by VARCHAR(255) REFERENCES users(id), created_at TIMESTAMP NOT NULL DEFAULT now())`,
  notifications: `CREATE TABLE IF NOT EXISTS notifications (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), title TEXT NOT NULL, body TEXT NOT NULL, type TEXT NOT NULL, priority INTEGER NOT NULL DEFAULT 3, project_id VARCHAR(255) REFERENCES projects(id), created_by VARCHAR(255) REFERENCES users(id), recipients TEXT[], payload JSONB, meta JSONB, read_by TEXT[], delivered_to TEXT[], scheduled_at TIMESTAMP, channel_preference JSONB, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  ai_chat_sessions: `CREATE TABLE IF NOT EXISTS ai_chat_sessions (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), user_id VARCHAR(255) NOT NULL REFERENCES users(id) ON DELETE CASCADE, title TEXT DEFAULT 'محادثة جديدة', is_active BOOLEAN DEFAULT true NOT NULL, last_message_at TIMESTAMP, messages_count INTEGER DEFAULT 0 NOT NULL, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  ai_chat_messages: `CREATE TABLE IF NOT EXISTS ai_chat_messages (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), session_id VARCHAR(255) NOT NULL REFERENCES ai_chat_sessions(id) ON DELETE CASCADE, role TEXT NOT NULL, content TEXT NOT NULL, model TEXT, provider TEXT, tokens_used INTEGER, action TEXT, action_data JSONB, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  ai_usage_stats: `CREATE TABLE IF NOT EXISTS ai_usage_stats (id VARCHAR(255) PRIMARY KEY DEFAULT gen_random_uuid(), user_id VARCHAR(255) NOT NULL REFERENCES users(id) ON DELETE CASCADE, date TEXT NOT NULL, provider TEXT NOT NULL, model TEXT NOT NULL, requests_count INTEGER DEFAULT 0 NOT NULL, tokens_used INTEGER DEFAULT 0 NOT NULL, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  well_tasks: `CREATE TABLE IF NOT EXISTS well_tasks (id SERIAL PRIMARY KEY, well_id INTEGER NOT NULL REFERENCES wells(id) ON DELETE CASCADE, task_type VARCHAR(50) NOT NULL, description TEXT, estimated_cost DECIMAL(12,2), actual_cost DECIMAL(12,2), task_order INTEGER NOT NULL, status TEXT NOT NULL DEFAULT 'pending', assigned_worker_id VARCHAR(255) REFERENCES workers(id) ON DELETE SET NULL, start_date DATE, completion_date DATE, completed_by VARCHAR(255) REFERENCES users(id) ON DELETE SET NULL, created_by VARCHAR(255) REFERENCES users(id) ON DELETE SET NULL, notes TEXT, created_at TIMESTAMP NOT NULL DEFAULT now(), updated_at TIMESTAMP NOT NULL DEFAULT now())`,
  well_task_accounts: `CREATE TABLE IF NOT EXISTS well_task_accounts (id SERIAL PRIMARY KEY, task_id INTEGER NOT NULL UNIQUE REFERENCES well_tasks(id) ON DELETE CASCADE, amount DECIMAL(12,2) NOT NULL, accounted_by VARCHAR(255) NOT NULL REFERENCES users(id), accounted_at TIMESTAMP NOT NULL DEFAULT now(), payment_method VARCHAR(50), reference_number VARCHAR(100), notes TEXT)`,
  well_expenses: `CREATE TABLE IF NOT EXISTS well_expenses (id SERIAL PRIMARY KEY, well_id INTEGER NOT NULL REFERENCES wells(id) ON DELETE CASCADE, expense_type VARCHAR(50) NOT NULL, reference_type VARCHAR(50), reference_id VARCHAR(255), description TEXT NOT NULL, category VARCHAR(100), quantity DECIMAL(10,2) NOT NULL, unit VARCHAR(20) NOT NULL, unit_price DECIMAL(12,2) NOT NULL, total_amount DECIMAL(12,2) NOT NULL, expense_date DATE NOT NULL, created_by VARCHAR(255) NOT NULL REFERENCES users(id), created_at TIMESTAMP NOT NULL DEFAULT now(), notes TEXT)`,
  well_audit_logs: `CREATE TABLE IF NOT EXISTS well_audit_logs (id SERIAL PRIMARY KEY, well_id INTEGER REFERENCES wells(id) ON DELETE SET NULL, task_id INTEGER REFERENCES well_tasks(id) ON DELETE SET NULL, action VARCHAR(50) NOT NULL, entity_type VARCHAR(50) NOT NULL, entity_id INTEGER NOT NULL, previous_data JSONB, new_data JSONB, user_id VARCHAR(255) NOT NULL REFERENCES users(id), ip_address INET, user_agent TEXT, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  material_categories: `CREATE TABLE IF NOT EXISTS material_categories (id SERIAL PRIMARY KEY, name VARCHAR(100) NOT NULL UNIQUE, name_ar VARCHAR(100) NOT NULL, type VARCHAR(20) NOT NULL, unit VARCHAR(20) NOT NULL, description TEXT, is_active BOOLEAN DEFAULT true NOT NULL, created_at TIMESTAMP NOT NULL DEFAULT now())`,
  equipment: `CREATE TABLE IF NOT EXISTS equipment (id SERIAL PRIMARY KEY, name TEXT NOT NULL, type TEXT, status TEXT DEFAULT 'active', project_id VARCHAR(255) REFERENCES projects(id), created_at TIMESTAMP NOT NULL DEFAULT now())`,
  equipment_movements: `CREATE TABLE IF NOT EXISTS equipment_movements (id SERIAL PRIMARY KEY, equipment_id INTEGER REFERENCES equipment(id), from_project_id VARCHAR(255) REFERENCES projects(id), to_project_id VARCHAR(255) REFERENCES projects(id), movement_date TIMESTAMP DEFAULT now(), notes TEXT)`,
  incidents: `CREATE TABLE IF NOT EXISTS incidents (id SERIAL PRIMARY KEY, title TEXT NOT NULL, severity TEXT NOT NULL, status TEXT NOT NULL, affected_devices INTEGER DEFAULT 0, app_version TEXT NOT NULL, last_occurrence TIMESTAMP DEFAULT now(), details JSONB)`,
  monitoring_metrics: `CREATE TABLE IF NOT EXISTS monitoring_metrics (id SERIAL PRIMARY KEY, name TEXT NOT NULL, value TEXT NOT NULL, timestamp TIMESTAMP DEFAULT now())`
};
